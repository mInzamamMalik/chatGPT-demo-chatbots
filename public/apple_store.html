<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatGPT DEMO</title>
</head>

<body>

    <nav>
        <button><a href="./index.html">Depression counselor</a></button>
        <button><a href="./apple_store.html">Apple Store</a></button>
        <button><a href="./grove_store.html">Grove Store</a></button>
    </nav>

    <h1>Apple Store Ai Assistant</h1>
    <p>this is an Ai Assistant for https://www.apple.com/. ask anything and it will reply by looking at the website data
        - Powered by Openai ChatGPT </p>


    <form onsubmit="sub(event); return false">
        <textarea type="text" id="query" autofocus style="width: 50%;"></textarea>

        <button type="Submit">Submit</button>
    </form>

    <p id="result"></p>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script type="module">
        window.hidden = "";

        window.sub = async function sub(event) {
            try {
                const start_sequence = "\n\nApple Store:"
                const restart_sequence = "\n\nYou: "

                const query = document.querySelector("#query").value;
                const result = document.querySelector("#result")

                result.innerText = `${restart_sequence} ${query}` + result.innerText
                window.hidden += `${restart_sequence} ${query}`

                console.log(event.target.reset());
                const res = await axios.post("/apple", {
                    "text": window.hidden,
                    start_sequence,
                    restart_sequence,
                })

                console.log("response: ", res.data.choices);
                console.log("response: ", res.data.choices[0]);
                console.log("response: ", res.data.choices[0].text);

                result.innerText = `${start_sequence} ${res.data.choices[0].text}` + result.innerText;
                window.hidden += `${start_sequence} ${res.data.choices[0].text}`

            } catch (error) {
                console.log("error: ", error.response || error);
            }
        }


    </script>

</body>

</html>